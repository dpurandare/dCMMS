# Vulnerability Management

**Document:** Vulnerability Management Procedures
**Version:** 1.0
**Last Updated:** 2025-11-19
**Owner:** Security Team

---

## Overview

This document defines the procedures for identifying, assessing, and remediating security vulnerabilities in the dCMMS platform.

---

## Vulnerability Scanning

### Scanning Tools

| Tool | Type | Target | Frequency | Owner |
|------|------|--------|-----------|-------|
| **Snyk** | SCA (Software Composition Analysis) | npm packages, Docker images | Daily (automated) | Security Engineer |
| **OWASP ZAP** | DAST (Dynamic Application Security Testing) | Web application, API | Weekly baseline, Monthly full | Security Engineer |
| **npm audit** | Dependency scanning | npm packages | Per deployment | DevOps |
| **Trivy** | Container scanning | Docker images | Per image build | DevOps |
| **Manual Penetration Testing** | External security audit | Entire platform | Annually | External firm |

### Scan Schedule

**Daily:**
- Snyk automated scans on all repositories
- npm audit in CI/CD pipeline

**Weekly:**
- OWASP ZAP baseline scan (5-10 minutes)
- Review Snyk findings and triage

**Monthly:**
- OWASP ZAP full scan (30-60 minutes)
- Container image vulnerability review
- Infrastructure security review

**Quarterly:**
- Comprehensive security assessment
- Penetration testing (internal team)

**Annually:**
- External penetration testing
- Red team exercise

---

## Vulnerability Severity Classification

### CVSS 3.1 Scoring

| CVSS Score | Severity | Remediation SLA | Priority |
|------------|----------|----------------|----------|
| **9.0-10.0** | Critical | 24 hours | P0 |
| **7.0-8.9** | High | 7 days | P1 |
| **4.0-6.9** | Medium | 30 days | P2 |
| **0.1-3.9** | Low | 90 days | P3 |

### Additional Factors

**Severity may be elevated if:**
- Exploit code publicly available
- Active exploitation in the wild
- Affects internet-facing services
- Impacts customer data (PII, financial)
- No authentication required

**Severity may be reduced if:**
- Requires privileged access
- Exploit extremely difficult
- Mitigating controls in place
- Service not exposed to internet

---

## Vulnerability Management Workflow

### 1. Detection

**Sources:**
- Automated scanning (Snyk, OWASP ZAP, Trivy)
- Security advisories (GitHub, npm, Ubuntu)
- Bug bounty program (future)
- Security researcher disclosure
- Internal security reviews

**Alert Routing:**
- Critical/High: PagerDuty → Security Engineer
- Medium/Low: Email → Security team inbox

### 2. Triage (Within 24 hours)

**Security team assesses:**
1. **Severity:** CVSS score + environmental factors
2. **Applicability:** Is dCMMS actually vulnerable?
3. **Exploitability:** Is exploit available/feasible?
4. **Business Impact:** Revenue, reputation, compliance risk

**Triage Decision:**
- ✅ **Accept Risk:** Documented exception (requires CISO approval)
- ✅ **Remediate:** Create ticket and assign
- ✅ **Mitigate:** Implement compensating controls
- ✅ **False Positive:** Mark as false positive, update scanner

### 3. Assignment (Within 48 hours)

**Ticket Creation:**
- Jira ticket created with severity label
- Assigned to appropriate engineering team
- Due date set based on SLA
- Linked to security vulnerability database

**Ticket Template:**
```
Title: [VULN] [Severity] [Component] Vulnerability Description

Description:
- CVE ID: CVE-YYYY-XXXXX
- CVSS Score: X.X (Severity)
- Affected Component: [Package/Service name]
- Current Version: vX.Y.Z
- Fixed Version: vX.Y.Z
- Description: [Vulnerability description]

Remediation:
- Recommended Action: [Upgrade to vX.Y.Z / Apply patch / Configuration change]
- References: [Links to security advisories]

Due Date: [Based on SLA]
Priority: [P0/P1/P2/P3]
```

### 4. Remediation

**Engineer Actions:**
1. Review vulnerability details
2. Identify fix (upgrade, patch, code change)
3. Test fix in development environment
4. Deploy to staging and verify
5. Deploy to production (per change management process)
6. Update ticket with remediation details

**For Critical Vulnerabilities:**
- Emergency change process may be used
- Testing may be expedited
- Deployment outside normal maintenance window

### 5. Verification (Within 24 hours of remediation)

**Security team verifies:**
1. Re-run vulnerability scan
2. Confirm vulnerability no longer detected
3. Verify fix doesn't introduce new issues
4. Update vulnerability tracking database

### 6. Closure

**Close ticket when:**
- ✅ Vulnerability no longer detected in scans
- ✅ Fix deployed to production
- ✅ Verification complete
- ✅ Documentation updated

---

## Special Handling

### Zero-Day Vulnerabilities

**Definition:** Vulnerability disclosed before fix available

**Process:**
1. **Immediate Assessment:** Determine if dCMMS is vulnerable
2. **Containment:** Implement workarounds/mitigations
   - WAF rules to block exploit attempts
   - Disable vulnerable feature (if possible)
   - Network-level blocking
3. **Monitoring:** Enhanced logging and alerting
4. **Apply Fix:** As soon as vendor releases patch
5. **Communication:** Update stakeholders on status

### Third-Party Service Vulnerabilities

**Examples:** AWS, GitHub, Stripe, SendGrid

**Process:**
1. Monitor vendor security bulletins
2. Assess impact to dCMMS
3. Verify vendor has patched/fixed
4. Update dCMMS integration if needed
5. Document in security log

### Responsible Disclosure

**For external researchers reporting vulnerabilities:**

**Process:**
1. Acknowledge receipt within 24 hours
2. Assess severity and validity
3. Provide timeline for fix (based on severity SLA)
4. Keep researcher updated on progress
5. Credit researcher (if they wish) upon disclosure
6. Offer bug bounty reward (when program launched)

**Disclosure Timeline:**
- Critical: Fix within 7 days, disclose within 30 days
- High: Fix within 30 days, disclose within 90 days

---

## Vulnerability Metrics

### Tracked Metrics (Monthly)

1. **Open Vulnerabilities by Severity**
   - Critical: 0 (target)
   - High: < 5 (target)
   - Medium: < 20 (target)
   - Low: < 50 (target)

2. **Mean Time to Remediate (MTTR)**
   - Critical: < 24 hours (target)
   - High: < 7 days (target)
   - Medium: < 30 days (target)
   - Low: < 90 days (target)

3. **SLA Compliance**
   - % of vulnerabilities remediated within SLA
   - Target: > 90%

4. **Vulnerability Backlog**
   - Count of overdue vulnerabilities
   - Target: 0 critical, < 3 high

5. **Scan Coverage**
   - % of systems scanned in last 30 days
   - Target: 100%

### Monthly Vulnerability Report

**Sections:**
1. Executive Summary
2. New vulnerabilities discovered
3. Vulnerabilities remediated
4. Open vulnerabilities by severity
5. SLA compliance
6. Trend analysis (3-month comparison)
7. Top vulnerable components
8. Recommendations

**Distribution:** Security Committee, Engineering Manager, CTO

---

## Exception Process

### When to Request Exception

- Fix causes breaking changes requiring major refactor
- Vulnerability requires extensive testing (> 90 days)
- Compensating controls adequately mitigate risk
- Upgrading dependency breaks other functionality

### Exception Approval

**Required Approvals:**
- Security Lead (all exceptions)
- CISO (Critical/High severity)
- CTO (Critical severity)

**Exception Duration:**
- Maximum: 90 days (renewable)
- Review: Every 30 days

**Exception Documentation:**
```
Vulnerability ID: CVE-YYYY-XXXXX
Severity: [Critical/High/Medium/Low]
Affected Component: [Name]

Reason for Exception:
[Detailed explanation]

Compensating Controls:
1. [Control 1]
2. [Control 2]

Residual Risk: [Low/Medium/High]

Exception Duration: [X days]
Renewal Date: [Date]

Approved By: [Name], [Title], [Date]
```

---

## Document Control

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2025-11-19 | Security Team | Initial version |

**Next Review Date:** 2026-02-19
